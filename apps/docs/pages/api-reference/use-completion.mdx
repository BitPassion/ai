---
title: useCompletion
---

# useCompletion

## `useCompletion(options: UseCompletionOptions): CompletionHelpers` [#usecompletion]

`useCompletion` is an SWR-powered React hook designed to handle text completion and the state of prompt inputs. This hook is useful when you need to integrate text completion capabilities into your React-based application.

Here's an example demonstrating the use of `useCompletion` in a simple text completion interface:

```tsx filename="app/completion.tsx"
'use client'

import { useCompletion } from 'ai-connector'

export default function Completion() {
  const {
    completion,
    input,
    stop,
    isLoading,
    handleInputChange,
    handleSubmit
  } = useCompletion({
    api: '/api/some-custom-endpoint'
  })

  return (
    <div className="mx-auto w-full max-w-md py-24 flex flex-col stretch">
      <form onSubmit={handleSubmit}>
        <input
          className="fixed w-full max-w-md bottom-0 border border-gray-300 rounded mb-8 shadow-xl p-2"
          value={input}
          placeholder="Enter your prompt..."
          onChange={handleInputChange}
        />
        <p>Completion result: {completion}</p>
        <button type="button" onClick={stop}>
          Stop
        </button>
        <button disabled={isLoading} type="submit">
          Submit
        </button>
      </form>
    </div>
  )
}
```

### `UseCompletionOptions`

- **`api?: string = '/api/completion'`** - The API endpoint that accepts a `{ prompt: string }` object and returns a stream of tokens for the AI completion response. Defaults to `/api/completion`.
- **`id?: string`** - An unique identifier for the completion. If not provided, a random one will be generated. When provided, the `useCompletion` hook with the same `id` will have shared states across components thanks to SWR.
- **`initialInput?: string = ''`** - An optional string for the initial prompt input.
- **`initialCompletion?: string = ''`** - An optional string for the initial completion result.
- **`onResponse?: (res: Response) => void`** - An optional callback function that is called with the response from the API endpoint. Useful for throwing customized errors or logging.
- **`onFinish?: (prompt: string, completion: string) => void`** - An optional callback function that is called when the completion stream ends.
- **`headers?: Record<string, string> | Headers`** - An optional object of headers to be passed to the API endpoint.
- **`body?: any`** - An optional, additional body object to be passed to the API endpoint.

### `UseCompletionHelpers`

The `useCompletion` hook returns an object with several helper methods and variables to manage the completion state:

- **`completion: string`** - The current text completion.
- **`complete: (prompt: string) => void`** - Function to execute text completion based on the provided prompt.
- **`error: any`** - An error object returned by SWR, if any.
- **`set: (completion: string) => void`** - Function to update the `completion` state.
- **`stop: () => void`** - Function to abort the current API request.
- **`input: string`** - The current value of the input field.
- **`setInput: React.Dispatch<React.SetStateAction<string>>`** - Function to update the `input` value.
- **`handleInputChange: (e: any) => void`** - Handler for the `onChange` event of the input field to control the input's value
- **`handleSubmit: (e: React.FormEvent<HTMLFormElement>) => void`** - Form submission handler that automatically resets the input field and appends a user message.
- **`isLoading: boolean`** - Boolean flag indicating whether an SWR fetch operation is currently in progress.
